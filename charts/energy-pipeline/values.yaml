# Assignment ID
assignmentId: "8d4e7f2a-5b3c-4a91-9e6d-1c8f0a2b3d4e"

# KEDA
keda:
  enabled: true
  minReplicaCount: 1
  maxReplicaCount: 3
  threshold: 5

# Ingestion API configuration
ingestionApi:
  replicaCount: 1
  image:
    repository: energy-pipeline/ingestion-api
    tag: latest
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 80
    targetPort: 8000
  resources:
    limits:
      cpu: 100m
      memory: 128Mi
    requests:
      cpu: 50m
      memory: 64Mi

# Processing Service configuration
processingService:
  replicaCount: 1
  image:
    repository: energy-pipeline/processing-service
    tag: latest
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 80
    targetPort: 8001
  resources:
    limits:
      cpu: 100m
      memory: 128Mi
    requests:
      cpu: 50m
      memory: 64Mi

# Frontend configuration
frontend:
  enabled: true
  replicaCount: 1
  image:
    repository: energy-pipeline/frontend
    tag: latest
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 80
  resources:
    limits:
      cpu: 50m
      memory: 64Mi
    requests:
      cpu: 25m
      memory: 32Mi

# Ingress configuration
ingress:
  enabled: false
  className: ""
  annotations: {}
    # nginx.ingress.kubernetes.io/rewrite-target: /
    # cert-manager.io/cluster-issuer: letsencrypt-prod
  hosts:
    - host: energy.frishchin.com
  tls: []
    # - secretName: energy-pipeline-tls
    #   hosts:
    #     - energy.frishchin.com

# Cloudflare Tunnel configuration
# 1. Create a tunnel in the Cloudflare Zero Trust dashboard
# 2. Add the tunnel token to a Kubernetes Secret:
#    kubectl create secret generic cloudflare-tunnel-token \
#      --from-literal=token=<YOUR_TUNNEL_TOKEN>
# 3. Configure public hostnames in the dashboard to point to:
#    - http://RELEASE-energy-pipeline-frontend:80  (for energy.frishchin.com)
cloudflare:
  enabled: false
  replicaCount: 1
  image:
    repository: cloudflare/cloudflared
    tag: latest
    pullPolicy: IfNotPresent
  tunnelToken:
    existingSecret: cloudflare-tunnel-token
    key: token
  resources:
    limits:
      cpu: 100m
      memory: 128Mi
    requests:
      cpu: 50m
      memory: 64Mi

# Redis configuration (Bitnami subchart)
redis:
  enabled: true
  architecture: standalone
  auth:
    enabled: false
  master:
    persistence:
      enabled: false
    resources:
      limits:
        cpu: 500m
        memory: 256Mi
      requests:
        cpu: 100m
        memory: 128Mi

# Common configuration
config:
  redisStream: energy_readings
  consumerGroup: processing_group
  processingDelayMs: 0  # Set >0 to simulate slow processing (useful for KEDA testing)
